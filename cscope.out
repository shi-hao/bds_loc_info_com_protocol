cscope 15 $HOME/bds/ver3 -q 0000000147 0000015506
	@bds_DataStruct.h

9 #iâdeà
BDS_DATASTRUCT


10 
	#BDS_DATASTRUCT


	)

12 
	#sh’yªg_v”


	)

14 
	#BYTE
 

	)

16 
	#WORD
 

	)

18 
	#DWORD
 

	)

20 
	#STRING
 *

	)

22 
	#M¬kCh¬
 0x7e

	)

23 
	#M¬kCh¬JuniÜ
 0x7d

	)

25 
	#MaxL’InBy‹


	)

31 
BYTE
 
	mmsg_id
[2];

32 
BYTE
 
	mmsg_body_´İ
[2];

33 
BYTE
 
	mphÚe_num
[10];

34 
BYTE
 
	mmsg_£rŸl_num
[2];

36 
BYTE
 
	mmsg_·ck‘_sum
[2];

37 
BYTE
 
	mmsg_·ck‘_num
[2];

39 
BYTE
 
	m‹rmš®_ty³
;

40 } 
	tmsg_h—d
, *
	tmsg_h—d_p
;

44 
	#msg_h—d_size_šBy‹
 21

	)

47 
	#msg_id_»g
 0x0100

	)

48 
	#msg_id_»g_»s
 0x8100

	)

49 
	#msg_id_uÄeg
 0x0003

	)

50 
	#msg_id_auth
 0x0102

	)

51 
	#msg_id_h—¹B—t
 0x0002

	)

52 
	#msg_id_loc_»pÜt
 0x0200

	)

53 
	#msg_id_£rv”_g’”®
 0x8001

	)

54 
	#msg_id_‹rmš®_g’”®
 0x0001

	)

57 
	#‹rmš®_ty³_ÿr_s
 0x00

	)

58 
	#‹rmš®_ty³_ÿr_ns
 0x01

	)

59 
	#‹rmš®_ty³_hªd_s
 0x02

	)

60 
	#‹rmš®_ty³_hªd_ns
 0x03

	)

61 
	#‹rmš®_ty³_sh_s
 0x04

	)

62 
	#‹rmš®_ty³_sh_ns
 0x05

	)

63 
	#‹rmš®_ty³_commªd
 0x06

	)

64 
	#‹rmš®_ty³_pdt
 0x07

	)

65 
	#‹rmš®_ty³_time
 0x08

	)

66 
	#‹rmš®_ty³_Ùh”s
 0x09

	)

73 
	#£t_msg_body_Ën
(
msg_body_´İ
, 
Ën
è(msg_body_´İ = (msg_body_´İ & 0xfc00è| ( 0x03fà&†’))

	)

76 
	#£t_msg_’c_sm2
(
msg_body_´İ
è(msg_body_´İ |ğ0x0400)

	)

79 
	#£t_msg_’c_sm4
(
msg_body_´İ
è(msg_body_´İ |ğ0x0800)

	)

82 
	#£t_msg_’c_sm1
(
msg_body_´İ
è(msg_body_´İ |ğ0x1000)

	)

85 
	#£t_msg_Ãt_c
(
msg_body_´İ
è(msg_body_´İ &ğ0x7fff)

	)

88 
	#£t_msg_Ãt_p
(
msg_body_´İ
è(msg_body_´İ |ğ0x8000)

	)

93 
	#£t_msg_·ck‘_æg
(
msg_body_´İ
,
æg
è((æg > 0è? (msg_body_´İ |ğ0x0200):(msg_body_´İ &ğ0xdfff))

	)

96 
	#»ad_msg_·ck‘_æg
(
msg_body_´İ
è(msg_body_´İ & 0x0200)

	)

99 
	#‹rmš®_»g_basic_Ën
 65

	)

101 
BYTE
 
	mpŞiû_Üg_code
[6];

102 
BYTE
 
	mmªuçùu»r_couÁry
[1];

103 
BYTE
 
	mmªuçùu»r_code
[18];

104 
BYTE
 
	m‹rmš®_mod–
[20];

105 
BYTE
 
	m‹rmš®_id
[20];

106 
BYTE
 
	mÿ¼›r_code
[20];

107 } 
	t‹rmš®_»g
, *
	t‹rmš®_»g_p
;

113 
BYTE
 
	m»s_£rŸl_num
[2];

114 
BYTE
 
	m»suÉ
;

115 
BYTE
 
	mauth_code
[40];

117 } 
	t‹rmš®_»g_»s
, *
	t‹rmš®_»g_»s_p
;

121 
	#‹rmš®_loc_»pÜt_basic_Ën
 30

	)

123 
BYTE
 
	m®¬m_æg
[4];

124 
BYTE
 
	m¡©
[4];

125 
BYTE
 
	mÏt
[4];

126 
BYTE
 
	mÊg
[4];

127 
BYTE
 
	mheight
[2];

128 
BYTE
 
	m¥“d
[2];

129 
BYTE
 
	mdœeùiÚ
[2];

130 
BYTE
 
	mtime
[6];

131 
BYTE
 
	mpdİ
[2];

132 } 
	t‹rmš®_loc_»pÜt
, *
	t‹rmš®_loc_»pÜt_p
;

135 
BYTE
 
	mid
;

136 
BYTE
 
	mËn
;

137 
BYTE
 
	mšfo
[7];

138 } 
	t‹rmš®_loc_©ch
, *
	t‹rmš®_loc_©ch_p
;

141 
BYTE
 
	m£rŸl_num
[2];

142 
BYTE
 
	mmsg_id
[2];

143 
BYTE
 
	m»suÉ
;

144 } 
	t£rv”_»s_g’”®
, *
	t£rv”_»s_g’”®_p
;

	@bds_data_proc.c

9 
	~<¡dio.h
>

10 
	~"bds_D©aSŒuù.h
"

11 
	~<¡ršg.h
>

15 * 
	$put32
(

16 * 
ı
,

17 
DWORD
 
x
)

19 *
ı
++ = 
x
 >> 24;

20 *
ı
++ = 
x
 >> 16;

21 *
ı
++ = 
x
 >> 8;

22 *
ı
++ = 
x
;

23  
ı
;

24 
	}
}

26 * 
	$put16
(

27 *
ı
,

28 
WORD
 
x
)

30 *
ı
++ = 
x
 >> 8;

31 *
ı
++ = 
x
;

33  
ı
;

34 
	}
}

36 
WORD
 
	$g‘16
(*
ı
)

38 
WORD
 
x
;

40 
x
 = *
ı
++;

41 
x
 <<= 8;

42 
x
 |ğ*
ı
;

43  
x
;

44 
	}
}

47 
DWORD
 
	$g‘32
(*
ı
)

49 
DWORD
 
rv®
;

51 
rv®
 = *
ı
++;

52 
rv®
 <<= 8;

53 
rv®
 |ğ*
ı
++;

54 
rv®
 <<= 8;

55 
rv®
 |ğ*
ı
++;

56 
rv®
 <<= 8;

57 
rv®
 |ğ*
ı
;

59  
rv®
;

60 
	}
}

63 
	$ÿl_msg_Ën
(

64 * 
buf
,

65 
buf_size
)

67 
út
;

68 
út
=0;út<
buf_size
;cnt++){

69 if(
buf
[
út
] == 0x7e)

71 
buf
[
út
] = 0x00;

72  
út
;

76 
	}
}

79 
BYTE
 
	$ÿl_check_code
(

80 * 
d©a
,

81 
d©a_size


84 
BYTE
 
check_code
=0;

85 
út
;

86 if(
d©a_size
 < 1)

88 
	`´štf
("cal_check_code sizeƒrror\n");

93 
út
=0;út<
d©a_size
;cnt++){

94 
check_code
 = check_cod^ 
d©a
[
út
];

97  
check_code
;

98 
	}
}

102 
	$v”ify_check_code
(

103 * 
d©a
,

104 
d©a_size


106 
BYTE
 
check_code
=0;

108 if(
d©a_size
 < 2){

109 
	`´štf
("verify_check_code sizeƒrror\n");

113 
check_code
 = 
	`ÿl_check_code
(
d©a
, 
d©a_size
-1);

114 if(
check_code
 =ğ
d©a
[
d©a_size
 - 1])

118 
	}
}

121 
	$»v”£_esÿ³_ch¬
(

122 * 
buf
,

123 
size
){

140 *
fÜm”
, *
Ï‰”
, *
’d
;

141 
fÜm”
 = 
buf
;

142 
Ï‰”
 = 
buf
;

143 
’d
 = 
buf
 + 
size
 -1;

144 ;
Ï‰”
 <ğ
’d
;†©‹r++, 
fÜm”
++){

145 if(*
Ï‰”
 == 0x7d){

146 *
fÜm”
 = 0x7ø+ *++
Ï‰”
;

148 *
fÜm”
 = *
Ï‰”
;

151  (
fÜm”
 - 
buf
);

152 
	}
}

158 
	$D©aPack‘InBy‹
(*
D©aH—d
, 
H—dL’
,

159 *
D©aBody
, 
BodyL’
,

160 * 
SndBuff
, 
size
){

162 
BYTE
 
check_code
=0;

163 
út
=0, 
út_¤c
=0, 
út_d¡
=0;

165 
SndBuff
[
út_d¡
++] = 
M¬kCh¬
;

168 
út
=0;út<
H—dL’
;cnt++){

169 
check_code
 = check_cod^ 
D©aH—d
[
út
];

171 if((
D©aH—d
[
út
] =ğ
M¬kCh¬
è|| (D©aH—d[út] =ğ
M¬kCh¬JuniÜ
))

173 if((
út_d¡
 + 1è>ğ
size
)

176 
SndBuff
[
út_d¡
++] = 
M¬kCh¬JuniÜ
;

177 
SndBuff
[
út_d¡
++] = 
D©aH—d
[
út
] - 0x7c;

179 if((
út_d¡
 + 1è>ğ
size
)

182 
SndBuff
[
út_d¡
++] = 
D©aH—d
[
út
];

187 if(
D©aBody
 != 0x00){

188 
út
=0;út<
BodyL’
;cnt++){

189 
check_code
 = check_cod^ 
D©aBody
[
út
];

191 if((
D©aBody
[
út
] =ğ
M¬kCh¬
è|| (D©aBody[út] =ğ
M¬kCh¬JuniÜ
))

193 if((
út_d¡
 + 1è>ğ
size
)

196 
SndBuff
[
út_d¡
++] = 
M¬kCh¬JuniÜ
;

197 
SndBuff
[
út_d¡
++] = 
D©aBody
[
út
] - 0x7c;

199 if((
út_d¡
 + 1è>ğ
size
)

202 
SndBuff
[
út_d¡
++] = 
D©aBody
[
út
];

208 if((
check_code
 =ğ
M¬kCh¬
è|| (check_cod=ğ
M¬kCh¬JuniÜ
))

210 if((
út_d¡
 + 1è>ğ
size
)

213 
SndBuff
[
út_d¡
++] = 
M¬kCh¬JuniÜ
;

214 
SndBuff
[
út_d¡
++] = 
check_code
 - 0x7c;

216 if((
út_d¡
 + 1è>ğ
size
)

219 
SndBuff
[
út_d¡
++] = 
check_code
;

222 if(
út_d¡
 >ğ
size
)

226 
SndBuff
[
út_d¡
++] = 
M¬kCh¬
;

230  
út_d¡
;

231 
	}
}

236 
	$my´štf
(

237 * 
¡ršg
,

238 * 
d©a
,

239 
d©a_size
){

240 
út
;

243 
	`´štf
("\n\n\n%s:", 
¡ršg
);

246 
út
=0;út<
d©a_size
;cnt++){

247 
	`´štf
("0x%.2x ", 
d©a
[
út
]);

249 
	}
}

	@bds_data_proc.h

9 #iâdeà
BDS_DATA_PROC_H


10 
	#BDS_DATA_PROC_H


	)

12 
	~"bds_D©aSŒuù.h
"

14 * 
put32
(* 
ı
, 
DWORD
 
x
);

15 * 
put16
(* 
ı
, 
WORD
 
x
);

17 
WORD
 
g‘16
(*
ı
);

18 
DWORD
 
g‘32
(*
ı
);

21 
BYTE
 
ÿl_check_code
(

22 * 
d©a
,

23 
d©a_size


27 
v”ify_check_code
(

28 * 
d©a
,

29 
d©a_size


33 
ÿl_msg_Ën
(

34 * 
buf
,

35 
buf_size
);

39 
»v”£_esÿ³_ch¬
(

40 * 
buf
,

41 
size
);

44 
D©aPack‘InBy‹
(*
D©aH—d
, 
H—dL’
,

45 *
D©aBody
, 
BodyL’
,

46 * 
SndBuff
, 
size
);

48 
my´štf
(

49 * 
¡ršg
,

50 * 
d©a
,

51 
d©a_size
);

	@test.c

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~"bds_D©aSŒuù.h
"

4 
	~"bds_d©a_´oc.h
"

7 
WORD
 
	gglo_£rŸl_num
=0;

8 
	#Debug
 1

	)

10 
	$maš
(){

12 
»s
,
út
;

13 * 
p
;

16 
tmp_msg_h—d_size
=0, 
tmp_msg_body_size
=0;

19 
BYTE
 
check_code
;

22 
BYTE
 
buf
[1024], 
buff
[1024*2];

25 
msg_h—d
 
my_msg_h—d
;

26 
WORD
 
my_msg_body_´İ
=0;

30 
‹rmš®_»g
 
my_‹rmš®_»g
={

41 
‹rmš®_loc_»pÜt
 
my_‹rmš®_loc_»pÜt
;

42 
BYTE
 
tmp_time
[6]={16,11,21,0,0,0};

45 
‹rmš®_loc_©ch
 
my_‹rmš®_loc_©ch
;

46 
BYTE
 
tmp_šfo
[7]={0x11,0x22,0x33};

48 
	`mem£t
(&
my_‹rmš®_loc_»pÜt
,0,(my_terminal_loc_report));

52 
	`put32
(
my_‹rmš®_loc_»pÜt
.
®¬m_æg
, 0xffffffff);

54 
	`put32
(
my_‹rmš®_loc_»pÜt
.
¡©
, 0xffffffff);

56 
	`put32
(
my_‹rmš®_loc_»pÜt
.
Ït
, 0xffffffff);

58 
	`put32
(
my_‹rmš®_loc_»pÜt
.
Êg
, 0xffffffff);

60 
	`put16
(
my_‹rmš®_loc_»pÜt
.
height
, 1000);

62 
	`put16
(
my_‹rmš®_loc_»pÜt
.
¥“d
, 90);

64 
	`put16
(
my_‹rmš®_loc_»pÜt
.
dœeùiÚ
, 90);

65 
	`memıy
(
my_‹rmš®_loc_»pÜt
.
time
, 
tmp_time
, (my_terminal_loc_report.time));

67 
	`put16
(
my_‹rmš®_loc_»pÜt
.
pdİ
, 1);

71 
my_‹rmš®_loc_©ch
.
id
 = 0x00;

72 
my_‹rmš®_loc_©ch
.
Ën
 = 3;

73 
	`memıy
(
my_‹rmš®_loc_©ch
.
šfo
, 
tmp_šfo
, (my_terminal_loc_attach.info));

77 
BYTE
 
auth_code
[20];

86 
	`mem£t
(&
my_msg_h—d
,0,(my_msg_head));

90 
	`put16
(
my_msg_h—d
.
msg_id
, 
msg_id_»g
);

91 
my_msg_h—d
.
‹rmš®_ty³
=
‹rmš®_ty³_ÿr_ns
;

93 
	`put16
(
my_msg_h—d
.
msg_£rŸl_num
, 
glo_£rŸl_num
);

95 
	`£t_msg_Ãt_c
(
my_msg_body_´İ
);

96 
	`£t_msg_’c_sm1
(
my_msg_body_´İ
);

99 
tmp_msg_body_size
 = (
my_‹rmš®_»g
);

100 
	`£t_msg_body_Ën
(
my_msg_body_´İ
, 
tmp_msg_body_size
);

101 
	`£t_msg_·ck‘_æg
(
my_msg_body_´İ
, 0);

103 
	`put16
(
my_msg_h—d
.
msg_body_´İ
, 
my_msg_body_´İ
);

106 
p
 = 
buf
;

107 
tmp_msg_h—d_size
 = 
	`msg_h—d_put
(&
my_msg_h—d
, 
p
, 1024);

108 if(
tmp_msg_h—d_size
 > 0)

109 
p
 +ğ
tmp_msg_h—d_size
;

111 
	`´štf
("\Ámp_msg_h—d_size=%d\n",
tmp_msg_h—d_size
);

115 
tmp_msg_body_size
 = 
	`msg_body_put_»g
(&
my_‹rmš®_»g
, 
p
, (
buf
è- 
tmp_msg_h—d_size
);

116 if(
tmp_msg_body_size
 > 0)

117 
p
 +ğ
tmp_msg_body_size
;

119 
	`´štf
("tmp_msg_body_size=%d\n",
tmp_msg_body_size
);

122 
check_code
 = 
	`ÿl_check_code
(
buf
, 
tmp_msg_h—d_size
 + 
tmp_msg_body_size
);

123 *
p
++ = 
check_code
;

125 
	`´štf
("check_code=0X%.2x\n", 
check_code
);

127 #ià
Debug


129 
p
 = 
buf
;

130 
út
=0;út<
tmp_msg_h—d_size
;cnt++)

131 
	`´štf
("0X%02x ", *
p
++);

132 
	`´štf
("\n==========\n");

134 
út
=0;út<
tmp_msg_body_size
;cnt++)

135 
	`´štf
("0X%02x ", *
p
++);

136 
	`´štf
("\n==========\n");

140 
»s
 = 
	`ÿl_esÿ³_ch¬
(
buf
, 
tmp_msg_h—d_size
+
tmp_msg_body_size
+1, 
buff
, (buff));

143 
p
 = 
buff
;

144 
	`´štf
("sum†’:%d\n", 
»s
);

145 
út
=0;út<
»s
;cnt++)

146 
	`´štf
("0X%02x ", *
p
++);

149 
	`mem£t
(
buf
, 0, 1024);

150 
	`mem£t
(
buff
, 0, 1024*2);

159 
	`mem£t
(&
my_msg_h—d
,0,(my_msg_head));

162 
my_msg_h—d
.
msg_id
=
msg_id_loc_»pÜt
;

163 
my_msg_h—d
.
‹rmš®_ty³
=
‹rmš®_ty³_ÿr_ns
;

164 
my_msg_h—d
.
msg_£rŸl_num
 = 
glo_£rŸl_num
++;

166 
	`£t_msg_Ãt_c
(
my_msg_body_´İ
);

167 
	`£t_msg_’c_sm1
(
my_msg_body_´İ
);

169 
tmp_msg_body_size
 = 
‹rmš®_loc_»pÜt_basic_Ën
 + 2 + 
my_‹rmš®_loc_©ch
.
Ën
;

170 
	`£t_msg_body_Ën
(
my_msg_body_´İ
, 
tmp_msg_body_size
);

171 
	`£t_msg_·ck‘_æg
(
my_msg_body_´İ
, 0);

172 
my_msg_h—d
.
msg_body_´İ
 = 
my_msg_body_´İ
;

175 
p
 = 
buf
;

176 
tmp_msg_h—d_size
 = 
	`msg_h—d_put
(&
my_msg_h—d
, 
p
, 1024);

177 if(
tmp_msg_h—d_size
 > 0)

178 
p
 +ğ
tmp_msg_h—d_size
;

180 
	`´štf
("\n\Ámp_msg_h—d_size=%d\n",
tmp_msg_h—d_size
);

183 
tmp_msg_body_size
 = 
	`msg_body_put_loc
(&
my_‹rmš®_loc_»pÜt
, &
my_‹rmš®_loc_©ch
, 
p
, (
buf
è- 
tmp_msg_h—d_size
);

184 if(
tmp_msg_body_size
 > 0)

185 
p
 +ğ
tmp_msg_body_size
;

187 
	`´štf
("tmp_msg_body_size=%d\n",
tmp_msg_body_size
);

191 
check_code
 = 
	`ÿl_check_code
(
buf
, 
tmp_msg_h—d_size
 + 
tmp_msg_body_size
);

192 *
p
++ = 
check_code
;

194 
	`´štf
("check_code=0X%.2x\n", 
check_code
);

196 #ià
Debug


198 
p
 = 
buf
;

199 
út
=0;út<
tmp_msg_h—d_size
;cnt++)

200 
	`´štf
("0X%02x ", *
p
++);

201 
	`´štf
("\n==========\n");

203 
út
=0;út<
tmp_msg_body_size
;cnt++)

204 
	`´štf
("0X%02x ", *
p
++);

205 
	`´štf
("\n==========\n");

209 
»s
 = 
	`ÿl_esÿ³_ch¬
(
buf
, 
tmp_msg_h—d_size
+
tmp_msg_body_size
+1, 
buff
, (buff));

212 
p
 = 
buff
;

213 
	`´štf
("sum†’:%d\n", 
»s
);

214 
út
=0;út<
»s
;cnt++)

215 
	`´štf
("0X%02x ", *
p
++);

218 
	}
}

	@test2.c

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~"bds_D©aSŒuù.h
"

4 
	~"bds_d©a_´oc.h
"

6 
WORD
 
	gglo_£rŸl_num
=0;

7 
	#Debug
 1

	)

10 
	#glo_d©a_buf_size
 2048

	)

11 
	gglo_d©a_buf
[
glo_d©a_buf_size
];

12 
	gglo_d©a_buf_pos
 = 0;

15 
	$cmd_´oc
(*
buf
, 
size
){

17 
»t
;

18 
‹rm_ty³
;

19 
msg_id
;

20 
msg_h—d_p
 
h—d
;

22 
»t
 = 
	`»v”£_esÿ³_ch¬
(
buf
, 
size
);

23 if(
	`v”ify_check_code
(
buf
, 
»t
) == 0){

25 
h—d
 =(
msg_h—d_p
)
buf
;

28 
msg_id
 = 
	`g‘16
(
h—d
->msg_id);

29 
	`´štf
("»cv msg id : %#x \n", 
msg_id
);

32 
‹rm_ty³
 = 
h—d
->
‹rmš®_ty³
;

33 
	`´štf
("‹rmš®y³ : %#x \n", 
‹rm_ty³
);

36 
	`´štf
("checke codeƒrror\n");

39 
	}
}

42 
	$d©a_´oc
(* 
buf
, 
size
){

43 
út
;

44 
út
=0;út<
size
;cnt++){

45 if(
buf
[
út
] !ğ
M¬kCh¬
){

46 
glo_d©a_buf
[
glo_d©a_buf_pos
++] = 
buf
[
út
];

47 if(
glo_d©a_buf_pos
 > 
glo_d©a_buf_size
){

48 
	`´štf
("\n glo_data_buf overflow\n");

49 
glo_d©a_buf_pos
 = 0;

52 
	`cmd_´oc
(
glo_d©a_buf
, 
glo_d©a_buf_pos
);

53 
glo_d©a_buf_pos
 = 0;

56 
	}
}

58 
	$maš
(){

60 
»s
,
út
;

61 * 
p
;

62 
£rŸl_d©a
[1024 * 4];

65 
tmp_msg_body_size
=0;

71 
BYTE
 
buf
[1024];

74 
msg_h—d
 
my_msg_h—d
;

75 
WORD
 
my_msg_body_´İ
=0;

78 
‹rmš®_»g
 
my_‹rmš®_»g
={

88 
‹rmš®_loc_»pÜt
 
my_‹rmš®_loc_»pÜt
;

89 
BYTE
 
tmp_time
[6]={16,11,21,0,0,0};

92 
‹rmš®_loc_©ch
 
my_‹rmš®_loc_©ch
;

93 
BYTE
 
tmp_šfo
[7]={0x11,0x22,0x33};

95 
	`mem£t
(&
my_‹rmš®_loc_»pÜt
,0,(my_terminal_loc_report));

98 
	`put32
(
my_‹rmš®_loc_»pÜt
.
®¬m_æg
, 0xffffffff);

99 
	`put32
(
my_‹rmš®_loc_»pÜt
.
¡©
, 0xffffffff);

100 
	`put32
(
my_‹rmš®_loc_»pÜt
.
Ït
, 0xffffffff);

101 
	`put32
(
my_‹rmš®_loc_»pÜt
.
Êg
, 0xffffffff);

102 
	`put16
(
my_‹rmš®_loc_»pÜt
.
height
, 1000);

103 
	`put16
(
my_‹rmš®_loc_»pÜt
.
¥“d
, 90);

104 
	`put16
(
my_‹rmš®_loc_»pÜt
.
dœeùiÚ
, 90);

105 
	`memıy
(
my_‹rmš®_loc_»pÜt
.
time
, 
tmp_time
, (my_terminal_loc_report.time));

106 
	`put16
(
my_‹rmš®_loc_»pÜt
.
pdİ
, 1);

110 
my_‹rmš®_loc_©ch
.
id
 = 0x00;

111 
my_‹rmš®_loc_©ch
.
Ën
 = 3;

112 
	`memıy
(
my_‹rmš®_loc_©ch
.
šfo
, 
tmp_šfo
, (my_terminal_loc_attach.info));

115 
BYTE
 
auth_code
[20];

123 
	`mem£t
(&
my_msg_h—d
,0,(my_msg_head));

126 
	`put16
(
my_msg_h—d
.
msg_id
, 
msg_id_»g
);

127 
my_msg_h—d
.
‹rmš®_ty³
=
‹rmš®_ty³_ÿr_ns
;

128 
	`put16
(
my_msg_h—d
.
msg_£rŸl_num
, 
glo_£rŸl_num
);

130 
	`£t_msg_Ãt_c
(
my_msg_body_´İ
);

131 
	`£t_msg_’c_sm1
(
my_msg_body_´İ
);

133 
tmp_msg_body_size
 = (
my_‹rmš®_»g
);

134 
	`£t_msg_body_Ën
(
my_msg_body_´İ
, 
tmp_msg_body_size
);

135 
	`£t_msg_·ck‘_æg
(
my_msg_body_´İ
, 0);

136 
	`put16
(
my_msg_h—d
.
msg_body_´İ
, 
my_msg_body_´İ
);

138 
»s
 = 
	`D©aPack‘InBy‹
((*)&
my_msg_h—d
, (my_msg_head),

139 (*)&
my_‹rmš®_»g
,(my_terminal_reg),

140 
buf
, 1024);

142 #ià
Debug


144 
	`´štf
("\n============%ld by‹ msg h—d===============\À",(
my_msg_h—d
));

145 
	`´štf
("\n============%ld by‹ msg body===============\À",(
my_‹rmš®_»g
));

146 
	`´štf
("\n============%d by‹ sum d©a===============\À",
»s
);

147 
p
 = 
buf
;

148 
út
=0;út<
»s
;cnt++)

149 
	`´štf
("0X%02x ", *
p
++);

151 
	`memıy
(
£rŸl_d©a
+1024, 
buf
, 1024);

159 
	`mem£t
(&
my_msg_h—d
,0,(my_msg_head));

160 
	`mem£t
(
buf
, 0, 1024);

163 
	`put16
(
my_msg_h—d
.
msg_id
, 
msg_id_loc_»pÜt
);

164 
my_msg_h—d
.
‹rmš®_ty³
=
‹rmš®_ty³_ÿr_ns
;

165 
	`put16
(
my_msg_h—d
.
msg_£rŸl_num
, 
glo_£rŸl_num
);

167 
	`£t_msg_Ãt_c
(
my_msg_body_´İ
);

168 
	`£t_msg_’c_sm1
(
my_msg_body_´İ
);

170 
tmp_msg_body_size
 = (
my_‹rmš®_loc_»pÜt
);

171 
	`£t_msg_body_Ën
(
my_msg_body_´İ
, 
tmp_msg_body_size
);

172 
	`£t_msg_·ck‘_æg
(
my_msg_body_´İ
, 0);

173 
	`put16
(
my_msg_h—d
.
msg_body_´İ
, 
my_msg_body_´İ
);

175 
»s
 = 
	`D©aPack‘InBy‹
((*)&
my_msg_h—d
, (my_msg_head),

176 (*)&
my_‹rmš®_loc_»pÜt
,(my_terminal_loc_report),

177 
buf
, 1024);

179 #ià
Debug


181 
	`´štf
("\n============%ld by‹ msg h—d===============\À",(
my_msg_h—d
));

182 
	`´štf
("\n============%ld by‹ msg body===============\À",(
my_‹rmš®_loc_»pÜt
));

183 
	`´štf
("\n============%d by‹ sum d©a===============\À",
»s
);

184 
p
 = 
buf
;

185 
út
=0;út<
»s
;cnt++)

186 
	`´štf
("0X%02x ", *
p
++);

188 
	`memıy
(
£rŸl_d©a
+2048, 
buf
, 1024);

192 
út
=0;(cnt+256)<=(1024*4);cnt+=256)

193 
	`d©a_´oc
(
£rŸl_d©a
, 256);

196 
	}
}

	@
1
.
0
5
64
bds_DataStruct.h
bds_data_proc.c
bds_data_proc.h
test.c
test2.c
